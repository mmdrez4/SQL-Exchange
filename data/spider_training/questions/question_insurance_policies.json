[
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Which claims caused more than 2 settlements or have the maximum claim value? List the date the claim was made and the claim id.",
        "query": "SELECT T1.Date_Claim_Made ,  T1.Claim_id FROM Claims AS T1 JOIN Settlements AS T2 ON T1.Claim_id  =  T2.Claim_id GROUP BY T1.Claim_id HAVING count(*)  >  2 UNION SELECT T1.Date_Claim_Made ,  T1.Claim_id FROM Claims AS T1 JOIN Settlements AS T2 ON T1.Claim_id  =  T2.Claim_id WHERE T1.Amount_Claimed  =  ( SELECT max(Amount_Claimed) FROM Claims )"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the claims that led to more than two settlements or have the maximum claim value. For each of them, return the date the claim was made and the id of the claim.",
        "query": "SELECT T1.Date_Claim_Made ,  T1.Claim_id FROM Claims AS T1 JOIN Settlements AS T2 ON T1.Claim_id  =  T2.Claim_id GROUP BY T1.Claim_id HAVING count(*)  >  2 UNION SELECT T1.Date_Claim_Made ,  T1.Claim_id FROM Claims AS T1 JOIN Settlements AS T2 ON T1.Claim_id  =  T2.Claim_id WHERE T1.Amount_Claimed  =  ( SELECT max(Amount_Claimed) FROM Claims )"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Which customer had at least 2 policies but did not file any claims? List the customer details and id.",
        "query": "SELECT T1.customer_details ,  T1.customer_id FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_id  =  T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >=  2 EXCEPT SELECT T1.customer_details ,  T1.customer_id FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_id  =  T2.customer_id JOIN Claims AS T3 ON T2.policy_id  =  T3.policy_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Give me the the customer details and id for the customers who had two or more policies but did not file any claims.",
        "query": "SELECT T1.customer_details ,  T1.customer_id FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_id  =  T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >=  2 EXCEPT SELECT T1.customer_details ,  T1.customer_id FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_id  =  T2.customer_id JOIN Claims AS T3 ON T2.policy_id  =  T3.policy_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "List the method, date and amount of all the payments, in ascending order of date.",
        "query": "SELECT Payment_Method_Code ,  Date_Payment_Made ,  Amount_Payment FROM Payments ORDER BY Date_Payment_Made ASC"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "What are the method, date and amount of each payment? Sort the list in ascending order of date.",
        "query": "SELECT Payment_Method_Code ,  Date_Payment_Made ,  Amount_Payment FROM Payments ORDER BY Date_Payment_Made ASC"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Among all the claims, what is the settlement amount of the claim with the largest claim amount? List both the settlement amount and claim amount.",
        "query": "SELECT Amount_Settled ,  Amount_Claimed FROM Claims ORDER BY Amount_Claimed DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the settlement amount of the claim with the largest claim amount. Show both the settlement amount and claim amount.",
        "query": "SELECT Amount_Settled ,  Amount_Claimed FROM Claims ORDER BY Amount_Claimed DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Among all the claims, what is the amount claimed in the claim with the least amount settled? List both the settlement amount and claim amount.",
        "query": "SELECT Amount_Settled ,  Amount_Claimed FROM Claims ORDER BY Amount_Settled ASC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the claimed amount in the claim with the least amount settled. Show both the settlement amount and claim amount.",
        "query": "SELECT Amount_Settled ,  Amount_Claimed FROM Claims ORDER BY Amount_Settled ASC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Among all the claims, which claims have a claimed amount larger than the average? List the date the claim was made and the date it was settled.",
        "query": "SELECT Date_Claim_Made ,  Date_Claim_Settled FROM Claims WHERE Amount_Claimed  >  ( SELECT avg(Amount_Claimed) FROM Claims )"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Give me the claim date, settlement date for all the claims whose claimed amount is larger than the average.",
        "query": "SELECT Date_Claim_Made ,  Date_Claim_Settled FROM Claims WHERE Amount_Claimed  >  ( SELECT avg(Amount_Claimed) FROM Claims )"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Among all the claims, which settlements have a claimed amount that is no more than the average? List the claim start date.",
        "query": "SELECT Date_Claim_Made FROM Claims WHERE Amount_Settled  <=  ( SELECT avg(Amount_Settled) FROM Claims )"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Return the claim start date for the claims whose claimed amount is no more than the average",
        "query": "SELECT Date_Claim_Made FROM Claims WHERE Amount_Settled  <=  ( SELECT avg(Amount_Settled) FROM Claims )"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "How many settlements does each claim correspond to? List the claim id and the number of settlements.",
        "query": "SELECT T1.Claim_id ,  count(*) FROM Claims AS T1 JOIN Settlements AS T2 ON T1.claim_id  =  T2.claim_id GROUP BY T1.claim_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the number of settlements each claim corresponds to. Show the number together with the claim id.",
        "query": "SELECT T1.Claim_id ,  count(*) FROM Claims AS T1 JOIN Settlements AS T2 ON T1.claim_id  =  T2.claim_id GROUP BY T1.claim_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Which claim incurred the most number of settlements? List the claim id, the date the claim was made, and the number.",
        "query": "SELECT T1.claim_id ,  T1.date_claim_made ,  count(*) FROM Claims AS T1 JOIN Settlements AS T2 ON T1.claim_id  =  T2.claim_id GROUP BY T1.claim_id ORDER BY count(*) DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the claim id and claim date of the claim that incurred the most settlement count. Also tell me the count.",
        "query": "SELECT T1.claim_id ,  T1.date_claim_made ,  count(*) FROM Claims AS T1 JOIN Settlements AS T2 ON T1.claim_id  =  T2.claim_id GROUP BY T1.claim_id ORDER BY count(*) DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "How many settlements were made on the claim with the most recent claim settlement date? List the number and the claim id.",
        "query": "SELECT count(*) ,  T1.claim_id FROM Claims AS T1 JOIN Settlements AS T2 ON T1.claim_id  =  T2.claim_id GROUP BY T1.claim_id ORDER BY T1.Date_Claim_Settled DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the claim id and the number of settlements made for the claim with the most recent settlement date.",
        "query": "SELECT count(*) ,  T1.claim_id FROM Claims AS T1 JOIN Settlements AS T2 ON T1.claim_id  =  T2.claim_id GROUP BY T1.claim_id ORDER BY T1.Date_Claim_Settled DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Of all the claims, what was the earliest date when any claim was made?",
        "query": "SELECT Date_Claim_Made FROM Claims ORDER BY Date_Claim_Made ASC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Tell me the the date when the first claim was made.",
        "query": "SELECT Date_Claim_Made FROM Claims ORDER BY Date_Claim_Made ASC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "What is the total amount of settlement made for all the settlements?",
        "query": "SELECT sum(Amount_Settled) FROM Settlements"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Compute the total amount of settlement across all the settlements.",
        "query": "SELECT sum(Amount_Settled) FROM Settlements"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Who are the customers that had more than 1 policy? List the customer details and id.",
        "query": "SELECT T1.customer_details ,  T1.customer_id FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_id  =  T2.Customer_id GROUP BY T1.customer_id HAVING count(*)  >  1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the the customer details and id for the customers who had more than one policy.",
        "query": "SELECT T1.customer_details ,  T1.customer_id FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_id  =  T2.Customer_id GROUP BY T1.customer_id HAVING count(*)  >  1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "What are the claim dates and settlement dates of all the settlements?",
        "query": "SELECT Date_Claim_Made ,  Date_Claim_Settled FROM Settlements"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Tell me the the claim date and settlement date for each settlement case.",
        "query": "SELECT Date_Claim_Made ,  Date_Claim_Settled FROM Settlements"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "What is the most popular payment method?",
        "query": "SELECT Payment_Method_Code FROM Payments GROUP BY Payment_Method_Code ORDER BY count(*) DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Which payment method is used the most often?",
        "query": "SELECT Payment_Method_Code FROM Payments GROUP BY Payment_Method_Code ORDER BY count(*) DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "With which kind of payment method were the least number of payments processed?",
        "query": "SELECT Payment_Method_Code FROM Payments GROUP BY Payment_Method_Code ORDER BY count(*) ASC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "What is the payment method that were used the least often?",
        "query": "SELECT Payment_Method_Code FROM Payments GROUP BY Payment_Method_Code ORDER BY count(*) ASC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "What is the total amount of payment?",
        "query": "SELECT sum(Amount_Payment) FROM Payments"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Compute the total amount of payment processed.",
        "query": "SELECT sum(Amount_Payment) FROM Payments"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "What are all the distinct details of the customers?",
        "query": "SELECT DISTINCT customer_details FROM Customers"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Return the distinct customer details.",
        "query": "SELECT DISTINCT customer_details FROM Customers"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Which kind of policy type was chosen by the most customers?",
        "query": "SELECT Policy_Type_Code FROM Customer_Policies GROUP BY Policy_Type_Code ORDER BY count(*) DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the policy type the most customers choose.",
        "query": "SELECT Policy_Type_Code FROM Customer_Policies GROUP BY Policy_Type_Code ORDER BY count(*) DESC LIMIT 1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "How many settlements are there in total?",
        "query": "SELECT count(*) FROM Settlements"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Count the total number of settlements made.",
        "query": "SELECT count(*) FROM Settlements"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Which Payments were processed with Visa? List the payment Id, the date and the amount.",
        "query": "SELECT Payment_ID ,  Date_Payment_Made ,  Amount_Payment FROM Payments WHERE Payment_Method_Code  =  'Visa'"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Give me the payment Id, the date and the amount for all the payments processed with Visa.",
        "query": "SELECT Payment_ID ,  Date_Payment_Made ,  Amount_Payment FROM Payments WHERE Payment_Method_Code  =  'Visa'"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "List the details of the customers who do not have any policies.",
        "query": "SELECT customer_details FROM Customers EXCEPT SELECT T1.customer_details FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.customer_id  =  T2.customer_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Which customers do not have any policies? Find the details of these customers.",
        "query": "SELECT customer_details FROM Customers EXCEPT SELECT T1.customer_details FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.customer_id  =  T2.customer_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "List the date the claim was made, the date it was settled and the amount settled for all the claims which had exactly one settlement.",
        "query": "SELECT T1.claim_id ,  T1.date_claim_made ,  T1.Date_Claim_Settled FROM Claims AS T1 JOIN Settlements AS T2 ON T1.Claim_id  =  T2.Claim_id GROUP BY T1.claim_id HAVING count(*)  =  1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Which claims had exactly one settlement? For each, tell me the the date the claim was made, the date it was settled and the amount settled.",
        "query": "SELECT T1.claim_id ,  T1.date_claim_made ,  T1.Date_Claim_Settled FROM Claims AS T1 JOIN Settlements AS T2 ON T1.Claim_id  =  T2.Claim_id GROUP BY T1.claim_id HAVING count(*)  =  1"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "Find the total claimed amount of all the claims.",
        "query": "SELECT sum(Amount_Claimed) FROM Claims"
    },
    {
        "dataset": "spider_training",
        "db_id": "insurance_policies",
        "question": "What is total amount claimed summed across all the claims?",
        "query": "SELECT sum(Amount_Claimed) FROM Claims"
    }
]