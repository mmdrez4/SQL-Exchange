[
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "what are the details of the cmi masters that have the cross reference code 'Tax'?",
        "query": "SELECT T1.cmi_details FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id  =  T2.master_customer_id WHERE T2.source_system_code  =  'Tax'"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "What is the cmi cross reference id that is related to at least one council tax entry? List the cross reference id and source system code.",
        "query": "SELECT T1.cmi_cross_ref_id ,  T1.source_system_code FROM CMI_Cross_References AS T1 JOIN Council_Tax AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id GROUP BY T1.cmi_cross_ref_id HAVING count(*)  >=  1"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "How many business rates are related to each cmi cross reference? List cross reference id, master customer id and the n",
        "query": "SELECT T2.cmi_cross_ref_id ,  T2.master_customer_id ,  count(*) FROM Business_Rates AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id GROUP BY T2.cmi_cross_ref_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "What is the tax source system code related to the benefits and overpayments? List the code and the benifit id, order by benifit id.",
        "query": "SELECT T1.source_system_code ,  T2.council_tax_id FROM CMI_Cross_References AS T1 JOIN Benefits_Overpayments AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id ORDER BY T2.council_tax_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "Wat is the tax source system code and master customer id of the taxes related to each parking fine id?",
        "query": "SELECT T1.source_system_code ,  T1.master_customer_id ,  T2.council_tax_id FROM CMI_Cross_References AS T1 JOIN Parking_Fines AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "What are the renting arrears tax ids related to the customer master index whose detail is not 'Schmidt, Kertzmann and Lubowitz'?",
        "query": "SELECT T1.council_tax_id FROM Rent_Arrears AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id JOIN Customer_Master_Index AS T3 ON T3.master_customer_id  =  T2.master_customer_id WHERE T3.cmi_details != 'Schmidt ,  Kertzmann and Lubowitz'"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "What are the register ids of electoral registries that have the cross reference source system code 'Electoral' or 'Tax'?",
        "query": "SELECT T1.electoral_register_id FROM Electoral_Register AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id WHERE T2.source_system_code  =  'Electoral' OR T2.source_system_code  =  'Tax'"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "How many different source system code for the cmi cross references are there?",
        "query": "SELECT count(DISTINCT source_system_code) FROM CMI_cross_references"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "List all information about customer master index, and sort them by details in descending order.",
        "query": "SELECT * FROM customer_master_index ORDER BY cmi_details DESC"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "List the council tax ids and their related cmi cross references of all the parking fines.",
        "query": "SELECT council_tax_id ,  cmi_cross_ref_id FROM parking_fines"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "How many council taxes are collected for renting arrears ?",
        "query": "SELECT count(*) FROM rent_arrears"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "What are the distinct cross reference source system codes which are related to the master customer details 'Gottlieb, Becker and Wyman'?",
        "query": "SELECT DISTINCT T2.source_system_code FROM customer_master_index AS T1 JOIN cmi_cross_references AS T2 ON T1.master_customer_id  =  T2.master_customer_id WHERE T1.cmi_details  =  'Gottlieb ,  Becker and Wyman'"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "Which cmi cross reference id is not related to any parking taxes?",
        "query": "SELECT cmi_cross_ref_id FROM cmi_cross_references EXCEPT SELECT cmi_cross_ref_id FROM parking_fines"
    },
    {
        "dataset": "spider_training",
        "db_id": "local_govt_mdm",
        "question": "Which distinct source system code includes the substring 'en'?",
        "query": "SELECT DISTINCT source_system_code FROM cmi_cross_references WHERE source_system_code LIKE '%en%'"
    }
]