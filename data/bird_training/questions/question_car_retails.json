[
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List the country and how many customers are there.",
        "query": "SELECT country, COUNT(customerNumber) FROM customers GROUP BY country"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which different vendor has the most amount of orders? Calculate the total estimated earnings.",
        "query": "SELECT DISTINCT T1.productVendor, T1.MSRP - T1.buyPrice FROM products AS T1 INNER JOIN orderdetails AS T2 ON T1.productCode = T2.productCode GROUP BY T1.productVendor, T1.MSRP, T1.buyPrice ORDER BY COUNT(T2.quantityOrdered) DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Who is the sales agent of the distinct customer who paid the highest amount in the year 2004?",
        "query": "SELECT DISTINCT T3.lastName, T3.firstName FROM payments AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber INNER JOIN employees AS T3 ON T2.salesRepEmployeeNumber = T3.employeeNumber WHERE STRFTIME('%Y', T1.paymentDate) = '2004' ORDER BY T1.amount DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What was the total price of the products shipped to Rovelli Gifts Distributors Ltd. between 1/1/2003 and 12/31/2003?",
        "query": "SELECT T3.priceEach * T3.quantityOrdered FROM customers AS T1 INNER JOIN orders AS T2 ON T1.customerNumber = T2.customerNumber INNER JOIN orderdetails AS T3 ON T2.orderNumber = T3.orderNumber WHERE T1.customerName = 'Rovelli Gifts' AND T2.status = 'Shipped' AND STRFTIME('%Y', T2.shippedDate) = '2003'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many employees are there in Sydney?",
        "query": "SELECT COUNT(employeeNumber) FROM employees WHERE officeCode = ( SELECT officeCode FROM offices WHERE city = 'Sydney' )"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which sales representatives in New York city whose leader is Anthony Bow with the employee number is 1143? Indicate their employee numbers.",
        "query": "SELECT T1.employeeNumber FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T1.reportsTo = 1143 AND T2.city = 'NYC'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the average, highest and lowest annual payments collected between 1/1/2003 to 12/31/2005?",
        "query": "SELECT CAST(SUM(T1.amount) AS REAL) / 3, MAX(T1.amount) , MIN(T1.amount) FROM payments AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber WHERE T1.paymentDate BETWEEN '2003-01-01' AND '2005-12-31'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which countries do the top 5 highest paying customers in a single payment come from? Indicate their entire address.",
        "query": "SELECT DISTINCT T2.country, T2.addressLine1, T2.addressLine2 FROM payments AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber ORDER BY T1.amount DESC LIMIT 5"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many checks were issued by Euro+ Shopping Channel in the year 2004?",
        "query": "SELECT COUNT(T1.checkNumber) FROM payments AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber WHERE customerName = 'Euro+ Shopping Channel' AND STRFTIME('%Y', T1.paymentDate) = '2004'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Of all the classic cars, with a product scale of 1:18, which product is the most ordered product by customers?",
        "query": "SELECT T1.productName FROM products AS T1 INNER JOIN orderdetails AS T2 ON T1.productCode = T2.productCode WHERE T1.productScale = '1:18' AND T1.productLine = 'Classic Cars' GROUP BY T1.productName ORDER BY SUM(T2.quantityOrdered) DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many customers have a credit limit of not more than 100,000 and which customer made the highest total payment amount for the year 2004?",
        "query": "SELECT ( SELECT COUNT(customerNumber) FROM customers WHERE creditLimit <= 100000 AND customerNumber IN ( SELECT customerNumber FROM payments WHERE STRFTIME('%Y', paymentDate) = '2004' ) ), T1.customerName FROM customers AS T1 INNER JOIN payments AS T2 ON T1.customerNumber = T2.customerNumber WHERE T1.creditLimit <= 100000 AND STRFTIME('%Y', T2.paymentDate) = '2004' GROUP BY T1.customerNumber, T1.customerName ORDER BY SUM(T2.amount) DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which of the customers, whose Tokyo-based sales representative reports to the Vice President of Sales whose employee number is 1056, has paid the highest payment? List the customer's name, the contact person and calculate the total amount of that customer's total payments.",
        "query": "SELECT T2.customerName, T2.contactFirstName, T2.contactLastName, SUM(T3.amount) FROM employees AS T1 INNER JOIN customers AS T2 ON T2.salesRepEmployeeNumber = T1.employeeNumber INNER JOIN payments AS T3 ON T2.customerNumber = T3.customerNumber INNER JOIN offices AS T4 ON T1.officeCode = T4.officeCode WHERE T4.city = 'Tokyo' AND T1.reportsTo = 1056 GROUP BY T2.customerName, T2.contactFirstName, T2.contactLastName ORDER BY amount DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which two products has the highest and lowest expected profits? Determine the total price for each product in terms of the largest quantity that was ordered.",
        "query": "SELECT T2.productName, SUM(T1.quantityOrdered * T1.priceEach) FROM orderdetails AS T1 INNER JOIN ( SELECT productCode, productName FROM products ORDER BY MSRP - buyPrice DESC LIMIT 1 ) AS T2 ON T1.productCode = T2.productCode UNION SELECT T2.productName, SUM(quantityOrdered * priceEach) FROM orderdetails AS T1 INNER JOIN ( SELECT productCode, productName FROM products ORDER BY MSRP - buyPrice ASC LIMIT 1 ) AS T2 ON T1.productCode = T2.productCode"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many different orders with a total price greater than 4000 are cancelled?",
        "query": "SELECT COUNT(DISTINCT T1.orderNumber) FROM orderdetails AS T1 INNER JOIN orders AS T2 ON T1.orderNumber = T2.orderNumber WHERE T1.quantityOrdered * T1.priceEach > 4000 AND T2.status = 'Cancelled'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many distinct orders were there in 2003 when the quantity ordered was less than 30?",
        "query": "SELECT COUNT(DISTINCT T1.orderNumber) FROM orderdetails AS T1 INNER JOIN orders AS T2 ON T1.orderNumber = T2.orderNumber WHERE T1.quantityOrdered < 30 AND STRFTIME('%Y', T2.orderDate) = '2003'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the total value of cancelled orders?",
        "query": "SELECT SUM(T1.quantityOrdered * T1.priceEach) FROM orderdetails AS T1 INNER JOIN orders AS T2 ON T1.orderNumber = T2.orderNumber WHERE T2.status = 'Cancelled'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please calculate the total value of Motorcycles orders.",
        "query": "SELECT SUM(T1.quantityOrdered * T1.priceEach) FROM orderdetails AS T1 INNER JOIN products AS T2 ON T1.productCode = T2.productCode WHERE T2.productLine = 'Motorcycles'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many Planes orders were there?",
        "query": "SELECT COUNT(T1.productCode) FROM orderdetails AS T1 INNER JOIN products AS T2 ON T1.productCode = T2.productCode WHERE T2.productLine = 'Planes'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many orders which expected profits greater than 100?",
        "query": "SELECT COUNT(T1.productCode) FROM orderdetails AS T1 INNER JOIN products AS T2 ON T1.productCode = T2.productCode WHERE T2.MSRP - T2.buyPrice > 100"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please calculate the average total price of orders from Exoto Designs Vendor in 2005.",
        "query": "SELECT SUM(T2.quantityOrdered * T2.priceEach) / COUNT(T3.orderNumber) FROM products AS T1 INNER JOIN orderdetails AS T2 ON T1.productCode = T2.productCode INNER JOIN orders AS T3 ON T2.orderNumber = T3.orderNumber WHERE T1.productVendor = 'Exoto Designs' AND STRFTIME('%Y', T3.orderDate) = '2005'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many sales representatives who have office code is 1?",
        "query": "SELECT COUNT(officeCode) FROM employees WHERE jobTitle = 'Sales Rep' AND officeCode = 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please list different customer names with the payment amount of over 50,000.",
        "query": "SELECT DISTINCT T2.customerName FROM payments AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber WHERE T1.amount > 50000"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please calculate the total payment amount of customers who come from the USA.",
        "query": "SELECT SUM(T1.amount) FROM payments AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber WHERE T2.country = 'USA'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What are the total payments of customers with no credit limit in 2003?",
        "query": "SELECT SUM(amount) FROM payments WHERE STRFTIME('%Y', paymentDate) = '2003' AND customerNumber IN ( SELECT customerNumber FROM customers WHERE creditLimit = 0 )"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please list the name and phone number of the customer whose order was cancelled.",
        "query": "SELECT T2.customerName, T2.phone FROM orders AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber WHERE T1.status = 'Cancelled'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many French customers shipped 2 orders which have been cancelled?",
        "query": "SELECT COUNT(T2.country) FROM orders AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber WHERE T1.status = 'Shipped' AND T2.country = 'France' GROUP BY T2.customerNumber HAVING COUNT(T1.status) = 2"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please calculate the average total price of shipped orders from German customers.",
        "query": "SELECT SUM(T3.quantityOrdered * T3.priceEach) / COUNT(T2.orderNumber) FROM customers AS T1 INNER JOIN orders AS T2 ON T1.customerNumber = T2.customerNumber INNER JOIN orderdetails AS T3 ON T2.orderNumber = T3.orderNumber WHERE T2.status = 'Shipped' AND T1.country = 'Germany'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List out full name of employees who are working in Tokyo?",
        "query": "SELECT T1.firstName, T1.lastName FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T2.city = 'Tokyo'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many Sales Rep who are working in Tokyo? List out email and full name of those employees.",
        "query": "SELECT T1.firstName, T1.lastName, T1.email FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T2.city = 'Tokyo' AND T1.jobTitle = 'Sales Rep'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "State the email of those who are staff of Murphy Diane whose number is 1002 and living in San Francisco",
        "query": "SELECT T1.email FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T1.reportsTo = 1002 AND T2.city = 'San Francisco'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Determine the email and Code of employee who are working at United State, state MA",
        "query": "SELECT T1.email, T1.employeeNumber FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T2.state = 'MA' AND T2.country = 'USA'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many Sales Manager who are working in Sydney? List out their email.",
        "query": "SELECT T1.email FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T1.jobTitle LIKE '%Sales Manager%' AND T2.city = 'Sydney'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many employees who are living in Australia and have the credit limit under 200000? State their email address and countries where they are working.",
        "query": "SELECT T2.email, T3.country FROM customers AS T1 INNER JOIN employees AS T2 ON T1.salesRepEmployeeNumber = T2.employeeNumber INNER JOIN offices AS T3 ON T2.officeCode = T3.officeCode WHERE T3.country = 'Australia' AND T1.creditLimit < 200000 AND T2.jobTitle = 'Sales Rep'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "State 10 emails of UK Sales Rep who have the lowest credit limit.",
        "query": "SELECT DISTINCT T2.email FROM customers AS T1 INNER JOIN employees AS T2 ON T1.salesRepEmployeeNumber = T2.employeeNumber WHERE T2.jobTitle = 'Sales Rep' AND T1.country = 'UK' ORDER BY T1.creditLimit LIMIT 10"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many Australian customers who have credit line under 220000?",
        "query": "SELECT COUNT(creditLimit) FROM customers WHERE creditLimit < 220000 AND country = 'Australia'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List out 3 customer numbers who have highest amount payment",
        "query": "SELECT customerNumber FROM payments ORDER BY amount DESC LIMIT 3"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Determine the email and Code of employee who are working at United State, state CA",
        "query": "SELECT T1.email, T1.employeeNumber FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T2.country = 'USA' AND T2.state = 'CA' GROUP BY T1.email, T1.officeCode"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List out full name of employees who are working in Boston?",
        "query": "SELECT T1.firstName, T1.lastName FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T2.city = 'Boston'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "State top 3 emails of UK Sales Rep who have the highest credit limit.",
        "query": "SELECT T2.email FROM customers AS T1 INNER JOIN employees AS T2 ON T1.salesRepEmployeeNumber = T2.employeeNumber WHERE T2.jobTitle = 'Sales Rep' AND T1.country = 'UK' GROUP BY T1.customerName, T2.email ORDER BY SUM(T1.creditLimit) DESC LIMIT 3"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many customers who are in Norway and have credit line under 220000?",
        "query": "SELECT COUNT(creditLimit) FROM customers WHERE creditLimit < 220000 AND country = 'Norway'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List out full name and email of employees who are working in Paris?",
        "query": "SELECT T1.firstName, T1.lastName, T1.email FROM employees AS T1 INNER JOIN offices AS T2 ON T1.officeCode = T2.officeCode WHERE T2.city = 'Paris'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List the product code of the top five motorcycles, by descending order, the number of quantity in stock.",
        "query": "SELECT productCode, quantityInStock FROM products WHERE productLine = 'Motorcycles' ORDER BY quantityInStock DESC LIMIT 5"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Among the German customers, how many of the them has credit limit of zero?",
        "query": "SELECT COUNT(customerNumber) FROM customers WHERE creditLimit = 0 AND country = 'Germany'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "From 2003 to 2004, how many customers have paid more than three times?",
        "query": "SELECT COUNT(customernumber) FROM ( SELECT customernumber FROM payments WHERE STRFTIME('%Y', paymentDate) >= '2003' AND STRFTIME('%Y', paymentDate) <= '2004' GROUP BY customernumber HAVING COUNT(customernumber) > 3 ) T"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the average actual profit by 1937 Lincoln Berline?",
        "query": "SELECT SUM(T1.priceEach - T2.buyPrice) / COUNT(*) FROM orderdetails AS T1 INNER JOIN products AS T2 ON T1.productCode = T2.productCode WHERE T2.productName = '1937 Lincoln Berline'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Among the motorcycles with product scale of 1:10, which of them is the most ordered by American customers?",
        "query": "SELECT T1.productName FROM products AS T1 INNER JOIN orderdetails AS T2 ON T1.productCode = T2.productCode INNER JOIN orders AS T3 ON T2.orderNumber = T3.orderNumber INNER JOIN customers AS T4 ON T3.customerNumber = T4.customerNumber WHERE T1.productLine = 'Motorcycles' AND T1.productScale = '1:10' AND T4.country = 'USA' GROUP BY T1.productName ORDER BY SUM(T2.quantityOrdered) DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Between 8/1/2003 and 8/30/2004, how many checks were issued by Mini Gifts Distributors Ltd.? Please list their check numbers.",
        "query": "SELECT T1.checkNumber FROM payments AS T1 INNER JOIN customers AS T2 ON T1.customerNumber = T2.customerNumber WHERE T1.paymentDate >= '2003-08-01' AND T1.paymentDate <= '2004-08-30' AND T2.customerName = 'Mini Gifts Distributors Ltd.'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "For the planes which has the hightest total price, how much it exceeds the average?",
        "query": "SELECT MAX(quantityOrdered * priceEach) - AVG(priceEach) FROM orderdetails WHERE productCode IN ( SELECT productCode FROM products WHERE productLine = 'Planes' )"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the total value of shipped vintage car orders from 2003-2004?",
        "query": "SELECT SUM(T2.priceEach * T2.quantityOrdered) FROM products AS T1 INNER JOIN orderdetails AS T2 ON T1.productCode = T2.productCode INNER JOIN orders AS T3 ON T2.orderNumber = T3.orderNumber WHERE T3.status = 'Shipped' AND T3.orderDate BETWEEN '2003-01-01' AND '2004-12-31'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Who is the sales agent of the customer who has made the highest payment? Include the full names of employee and his/her supervisor.",
        "query": "SELECT T1.firstName, T1.lastName, T1.reportsTo FROM employees AS T1 INNER JOIN customers AS T2 ON T1.employeeNumber = T2.salesRepEmployeeNumber INNER JOIN payments AS T3 ON T2.customerNumber = T3.customerNumber ORDER BY T3.amount DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the highest amount of order made by the sales representative in Boston? Please give the name of the product and amount.",
        "query": "SELECT T2.productName, T1.quantityOrdered * T1.priceEach FROM orderdetails AS T1 INNER JOIN products AS T2 ON T1.productCode = T2.productCode INNER JOIN orders AS T3 ON T1.orderNumber = T3.orderNumber INNER JOIN customers AS T4 ON T3.customerNumber = T4.customerNumber WHERE T4.city = 'Boston' AND T4.salesRepEmployeeNumber IN ( SELECT employeeNumber FROM employees WHERE jobTitle = 'Sales Rep' ) ORDER BY T1.quantityOrdered DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the total actual profit gained from orders made by American customers from 2003-01-06 to 2005-05-09?",
        "query": "SELECT SUM(T2.priceEach - T1.buyPrice) FROM products AS T1 INNER JOIN orderdetails AS T2 ON T1.productCode = T2.productCode INNER JOIN orders AS T3 ON T2.orderNumber = T3.orderNumber INNER JOIN customers AS T4 ON T3.customerNumber = T4.customerNumber WHERE T3.orderDate > '2003-01-05' AND T3.orderDate < '2005-05-10'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "From which branch does the sales representative employee who made the most sales in 2005? Please indicates its full address and phone number.",
        "query": "SELECT T3.addressLine1, T3.addressLine2, T3.phone FROM orderdetails AS T1 INNER JOIN orders AS T2 ON T1.orderNumber = T2.orderNumber INNER JOIN customers AS T3 ON T2.customerNumber = T3.customerNumber INNER JOIN employees AS T4 ON T3.salesRepEmployeeNumber = T4.employeeNumber INNER JOIN offices AS T5 ON T4.officeCode = T5.officeCode WHERE STRFTIME('%Y', T2.orderDate) = '2005' AND T4.jobTitle = 'Sales Rep' ORDER BY T1.quantityOrdered DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the phone number of all companies where the last name of the contact person starts with the letter M and are not from Germany?",
        "query": "SELECT phone FROM customers WHERE contactLastName LIKE 'M%' AND country != 'Germany'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Calculate the average amount of payments made by customers during the first half of 2004.",
        "query": "SELECT AVG(amount) FROM payments WHERE paymentDate BETWEEN '2004-01-01' AND '2004-06-30'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Of all the orders placed and shipped throughout the year 2005, what percentage of those orders corresponds to customer number 186?",
        "query": "SELECT CAST(SUM(CASE WHEN customerNumber = 186 THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(orderNumber) FROM orders WHERE status = 'Shipped' AND shippedDate BETWEEN '2005-01-01' AND '2005-12-31'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many customers with a canceled shipment have a credit limit greater than 115,000?",
        "query": "SELECT COUNT(T1.customerNumber) FROM customers AS T1 INNER JOIN orders AS T2 ON T1.customerNumber = T2.customerNumber WHERE T2.status = 'Cancelled' AND T1.creditLimit > 115000"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "On what date did the customer with the lowest credit limit serviced by sales representative Barry Jones make payments for his/her orders?",
        "query": "SELECT T3.paymentDate FROM employees AS T1 INNER JOIN customers AS T2 ON T1.employeeNumber = T2.salesRepEmployeeNumber INNER JOIN payments AS T3 ON T2.customerNumber = T3.customerNumber WHERE T1.firstName = 'Barry' AND T1.lastName = 'Jones' AND T1.jobTitle = 'Sales Rep' ORDER BY T2.creditLimit ASC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "To whom does the employee have to inform that is the sales representative of the French customer?",
        "query": "SELECT T1.reportsTo FROM employees AS T1 INNER JOIN customers AS T2 ON T1.employeeNumber = T2.salesRepEmployeeNumber WHERE T2.country = 'France'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the full address of the customer who commented that DHL be used for the order that was shipped on April 4, 2005?",
        "query": "SELECT T1.addressLine1, T1.addressLine2 FROM customers AS T1 INNER JOIN orders AS T2 ON T1.customerNumber = T2.customerNumber WHERE T2.shippedDate = '2005-04-04' AND T2.status = 'Shipped'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the full address of the office where the employee who is a sales representative for the customer whose business is located in the city of New York works?",
        "query": "SELECT T2.addressLine1, T2.addressLine2 FROM employees AS T1 INNER JOIN customers AS T2 ON T1.employeeNumber = T2.salesRepEmployeeNumber INNER JOIN offices AS T3 ON T1.officeCode = T3.officeCode WHERE T2.city = 'NYC' AND T1.jobTitle = 'Sales Rep'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the full address of the office where 4 people work and one of them is Sales Representation?",
        "query": "SELECT T1.addressLine1, T1.addressLine2 FROM customers AS T1 INNER JOIN employees AS T2 ON T1.salesRepEmployeeNumber = T2.employeeNumber WHERE T2.jobTitle = 'Sales Rep'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What profit can the seller Carousel DieCast Legends make from the sale of the product described as \"The perfect holiday or anniversary gift for executives\"?",
        "query": "SELECT SUM(T2.MSRP - T2.buyPrice) FROM productlines AS T1 INNER JOIN products AS T2 ON T1.productLine = T2.productLine WHERE T2.productVendor = 'Carousel DieCast Legends' AND T1.textDescription LIKE '%perfect holiday or anniversary gift for executives%'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Of the clients whose businesses are located in the city of Boston, calculate which of them has a higher average amount of payment.",
        "query": "SELECT T1.customerNumber FROM customers AS T1 INNER JOIN payments AS T2 ON T1.customerNumber = T2.customerNumber WHERE T1.city = 'Boston' GROUP BY T1.customerNumber ORDER BY SUM(T2.amount) / COUNT(T2.paymentDate) DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Calculate the total quantity ordered for 18th Century Vintage Horse Carriage and the average price.",
        "query": "SELECT SUM(T2.quantityOrdered) , SUM(T2.quantityOrdered * T2.priceEach) / SUM(T2.quantityOrdered) FROM products AS T1 INNER JOIN orderdetails AS T2 ON T1.productCode = T2.productCode WHERE T1.productName = '18th Century Vintage Horse Carriage'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many kinds of products did order No. 10252 contain?",
        "query": "SELECT COUNT(t.productCode) FROM orderdetails t WHERE t.orderNumber = '10252'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Who is the sales representative that made the order which was sent to 25 Maiden Lane, Floor No. 4?",
        "query": "SELECT T2.firstName, T2.lastName FROM customers AS T1 INNER JOIN employees AS T2 ON T1.salesRepEmployeeNumber = T2.employeeNumber WHERE T1.addressLine1 = '25 Maiden Lane' AND T1.addressLine2 = 'Floor No. 4'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Where's Foon Yue Tseng's office located at? Give the detailed address.",
        "query": "SELECT T1.addressLine1, T1.addressLine2 FROM offices AS T1 INNER JOIN employees AS T2 ON T1.officeCode = T2.officeCode WHERE T2.firstName = 'Foon Yue' AND T2.lastName = 'Tseng'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Compared with the orders happened on 2005-04-08 and two days later, which day's order had a higher value?",
        "query": "SELECT T2.orderDate FROM orderdetails AS T1 INNER JOIN orders AS T2 ON T1.orderNumber = T2.orderNumber WHERE STRFTIME('%Y-%m-%d', T2.orderDate) = '2005-04-08' OR STRFTIME('%Y-%m-%d', T2.orderDate) = '2005-04-10' ORDER BY T1.quantityOrdered * T1.priceEach DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many products with the highest expected profits were sold in total?",
        "query": "SELECT SUM(t2.quantityOrdered) FROM orderdetails AS t2 INNER JOIN ( SELECT t1.productCode FROM products AS t1 ORDER BY t1.MSRP - t1.buyPrice DESC LIMIT 1 ) AS t3 ON t2.productCode = t3.productCode"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How much did Petit Auto pay on 2004-08-09?",
        "query": "SELECT t1.amount FROM payments AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE t2.customerName = 'Petit Auto' AND t1.paymentDate = '2004-08-09'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What was the contact name for the check \"NR157385\"?",
        "query": "SELECT t2.contactFirstName, t2.contactLastName FROM payments AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE t1.checkNumber = 'NR157385'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which customer made the order No. 10160? Give the contact name.",
        "query": "SELECT t2.contactFirstName, t2.contactLastName FROM orders AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE t1.orderNumber = '10160'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Where was the order No. 10383 shipped to? Show me the address.",
        "query": "SELECT t2.addressLine1, t2.addressLine2 FROM orders AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE t1.orderNumber = '10383'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "For the productline where the product No.S18_2949 was produced, what's the text description for that product line?",
        "query": "SELECT t1.textDescription FROM productlines AS t1 INNER JOIN products AS t2 ON t1.productLine = t2.productLine WHERE t2.productCode = 'S18_2949'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "If Dragon Souveniers, Ltd. aren't satisfied with their order and want to send a complain e-mail, which e-mail address should they send to?",
        "query": "SELECT t2.email FROM customers AS t1 INNER JOIN employees AS t2 ON t1.salesRepEmployeeNumber = t2.employeeNumber WHERE t1.customerName = 'Dragon Souveniers, Ltd.'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many French customers does Gerard Hernandez take care of?",
        "query": "SELECT COUNT(t1.customerNumber) FROM customers AS t1 INNER JOIN employees AS t2 ON t1.salesRepEmployeeNumber = t2.employeeNumber WHERE t1.country = 'France' AND t2.firstName = 'Gerard' AND t2.lastName = 'Hernandez'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What was the latest order that customer No.114 made? Give the name of the product.",
        "query": "SELECT t3.productName FROM orderdetails AS t1 INNER JOIN orders AS t2 ON t1.orderNumber = t2.orderNumber INNER JOIN products AS t3 ON t1.productCode = t3.productCode WHERE t2.customerNumber = '114' ORDER BY t2.orderDate DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "For the product No. S18_3482 in the Order No.10108, how much discount did the customer have?",
        "query": "SELECT (t1.MSRP - t2.priceEach) / t1.MSRP FROM products AS t1 INNER JOIN orderdetails AS t2 ON t1.productCode = t2.productCode WHERE t1.productCode = 'S18_3482' AND t2.orderNumber = '10108'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "To whom does Steve Patterson report? Please give his or her full name.",
        "query": "SELECT t2.firstName, t2.lastName FROM employees AS t1 INNER JOIN employees AS t2 ON t2.employeeNumber = t1.reportsTo WHERE t1.firstName = 'Steve' AND t1.lastName = 'Patterson'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How do I contact the President of the company?",
        "query": "SELECT t.email FROM employees t WHERE t.jobTitle = 'President'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Who is the sales representitive of Muscle Machine Inc? Please give the employee's full name.",
        "query": "SELECT t2.firstName, t2.lastName FROM customers AS t1 INNER JOIN employees AS t2 ON t1.salesRepEmployeeNumber = t2.employeeNumber WHERE t1.customerName = 'Muscle Machine Inc'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "If I'm from the Muscle Machine Inc, to which e-mail adress should I write a letter if I want to reach the superior of my sales representitive?",
        "query": "SELECT t2.email FROM customers AS t1 INNER JOIN employees AS t2 ON t1.salesRepEmployeeNumber = t2.employeeNumber WHERE t1.customerName = 'Muscle Machine Inc'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please list all the customers that have Steve Patterson as their sales representitive.",
        "query": "SELECT t1.customerName FROM customers AS t1 INNER JOIN employees AS t2 ON t1.salesRepEmployeeNumber = t2.employeeNumber WHERE t2.firstName = 'Steve' AND t2.lastName = 'Patterson'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many customers have an employee who reports to William Patterson as their sales representitive?",
        "query": "SELECT COUNT(t1.customerNumber) FROM customers AS t1 INNER JOIN employees AS t2 ON t1.salesRepEmployeeNumber = t2.employeeNumber WHERE t2.firstName = 'William' AND t2.lastName = 'Patterson'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please list the phone numbers of the top 3 customers that have the highest credit limit and have Leslie Jennings as their sales representitive.",
        "query": "SELECT t1.phone FROM customers AS t1 INNER JOIN employees AS t2 ON t1.salesRepEmployeeNumber = t2.employeeNumber WHERE t2.firstName = 'Leslie' AND t2.lastName = 'Jennings' ORDER BY t1.creditLimit DESC LIMIT 3"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many sales representitives are based in the offices in the USA?",
        "query": "SELECT COUNT(t1.employeeNumber) FROM employees AS t1 INNER JOIN offices AS t2 ON t1.officeCode = t2.officeCode WHERE t2.country = 'USA' AND t1.jobTitle = 'Sales Rep'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Where can I find the office of the President of the company?",
        "query": "SELECT t2.addressLine1, t2.addressLine2 FROM employees AS t1 INNER JOIN offices AS t2 ON t1.officeCode = t2.officeCode WHERE t1.jobTitle = 'President'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What's the postal code of the office the VP Sales is at?",
        "query": "SELECT t2.postalCode FROM employees AS t1 INNER JOIN offices AS t2 ON t1.officeCode = t2.officeCode WHERE t1.jobTitle = 'VP Sales'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the total price of the order made by Cruz & Sons Co. on 2003/3/3?",
        "query": "SELECT SUM(t1.priceEach * t1.quantityOrdered) FROM orderdetails AS t1 INNER JOIN orders AS t2 ON t1.orderNumber = t2.orderNumber INNER JOIN customers AS t3 ON t2.customerNumber = t3.customerNumber WHERE t3.customerName = 'Cruz & Sons Co.' AND t2.orderDate = '2003-03-03'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which product did Cruz & Sons Co. order on 2003/3/3?",
        "query": "SELECT t4.productName FROM orderdetails AS t1 INNER JOIN orders AS t2 ON t1.orderNumber = t2.orderNumber INNER JOIN customers AS t3 ON t2.customerNumber = t3.customerNumber INNER JOIN products AS t4 ON t1.productCode = t4.productCode WHERE t3.customerName = 'Cruz & Sons Co.' AND t2.orderDate = '2003-03-03'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which product did Cruz & Sons Co. ask for the biggest amount in a single order?",
        "query": "SELECT t4.productName FROM orderdetails AS t1 INNER JOIN orders AS t2 ON t1.orderNumber = t2.orderNumber INNER JOIN customers AS t3 ON t2.customerNumber = t3.customerNumber INNER JOIN products AS t4 ON t1.productCode = t4.productCode WHERE t3.customerName = 'Cruz & Sons Co.' ORDER BY t1.priceEach * t1.quantityOrdered DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "When were the products ordered by Cruz & Sons Co. on 2003-03-03 shipped?",
        "query": "SELECT t1.shippedDate FROM orders AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE t2.customerName = 'Cruz & Sons Co.' AND t1.orderDate = '2003-03-03'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the amount of customers of 1957 Chevy Pickup by customers in a month?",
        "query": "SELECT COUNT(T2.customerNumber) FROM orderdetails AS T1 INNER JOIN orders AS T2 ON T1.orderNumber = T2.orderNumber WHERE T1.productCode IN ( SELECT productCode FROM products WHERE productName = '1957 Chevy Pickup' )"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Name the product from the 'Classic Cars' production line that has the greatest expected profit.",
        "query": "SELECT t.productName, t.MSRP - t.buyPrice FROM products AS t WHERE t.productLine = 'Classic Cars' ORDER BY t.MSRP - t.buyPrice DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List all the name of customers who have orders that are still processing.",
        "query": "SELECT t2.customerName FROM orders AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE t1.status = 'In Process'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Among all orders shipped, calculate the percentage of orders shipped at least 3 days before the required date.",
        "query": "SELECT COUNT(CASE WHEN JULIANDAY(t1.shippeddate) - JULIANDAY(t1.requireddate) > 3 THEN T1.customerNumber ELSE NULL END) FROM orders AS T1 INNER JOIN orderdetails AS T2 ON T1.orderNumber = T2.orderNumber WHERE T1.status = 'Shipped'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Find the customer who made the highest payment in 2005.",
        "query": "SELECT t2.customerName FROM payments AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE STRFTIME('%Y', t1.paymentDate) = '2005' GROUP BY t2.customerNumber, t2.customerName ORDER BY SUM(t1.amount) DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which is the most ordered quantity product? What is its expected profit margin per piece?",
        "query": "SELECT productName, MSRP - buyPrice FROM products WHERE productCode = ( SELECT productCode FROM orderdetails ORDER BY quantityOrdered DESC LIMIT 1 )"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "For the order has the most product ordered, name the customer who placed the order.",
        "query": "SELECT T2.firstName, T2.lastName FROM offices AS T1 INNER JOIN employees AS T2 ON T1.officeCode = T2.officeCode WHERE T2.employeeNumber = ( SELECT MAX(employeeNumber) FROM employees )"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List all customer names with orders that are disputed.",
        "query": "SELECT t3.firstName, t3.lastName FROM orders AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber INNER JOIN employees AS t3 ON t2.salesRepEmployeeNumber = t3.employeeNumber WHERE t1.status = 'Disputed'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the percentage of employees are in Paris office?",
        "query": "SELECT CAST(COUNT(CASE WHEN t1.city = 'Paris' THEN t2.employeeNumber ELSE NULL END) AS REAL) * 100 / COUNT(t2.employeeNumber) FROM offices AS t1 INNER JOIN employees AS t2 ON t1.officeCode = t2.officeCode"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Name the Sales Manager of Europe, Middle East, and Africa region. In which office does he/she report to?",
        "query": "SELECT t2.firstName, t2.lastName FROM offices AS t1 INNER JOIN employees AS t2 ON t1.officeCode = t2.officeCode WHERE t2.jobTitle = 'Sale Manager (EMEA)'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List the name of employees in Japan office and who are they reporting to.",
        "query": "SELECT t2.firstName, t2.lastName, t2.reportsTo FROM offices AS t1 INNER JOIN employees AS t2 ON t1.officeCode = t2.officeCode WHERE t1.country = 'Japan'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which customer ordered 1939 'Chevrolet Deluxe Coupe' at the highest price?",
        "query": "SELECT t4.customerName FROM products AS t1 INNER JOIN orderdetails AS t2 ON t1.productCode = t2.productCode INNER JOIN orders AS t3 ON t2.orderNumber = t3.orderNumber INNER JOIN customers AS t4 ON t3.customerNumber = t4.customerNumber WHERE t1.productName = '1939 Chevrolet Deluxe Coupe' ORDER BY t2.priceEach DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the percentage of the payment amount in 2004 was made by Atelier graphique?",
        "query": "SELECT SUM(CASE WHEN t1.customerName = 'Atelier graphique' THEN t2.amount ELSE 0 END) * 100 / SUM(t2.amount) FROM customers AS t1 INNER JOIN payments AS t2 ON t1.customerNumber = t2.customerNumber WHERE STRFTIME('%Y', t2.paymentDate) = '2004'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Calculate the actual profit for order number 10100.",
        "query": "SELECT SUM((t1.priceEach - t2.buyPrice) * t1.quantityOrdered) FROM orderdetails AS t1 INNER JOIN products AS t2 ON t1.productCode = t2.productCode WHERE t1.orderNumber = '10100'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How much did customer 103 pay in total?",
        "query": "SELECT SUM(t.amount) FROM payments t WHERE t.customerNumber = '103'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "What is the total price of the order 10100?",
        "query": "SELECT SUM(t.priceEach * t.quantityOrdered) FROM orderdetails t WHERE t.orderNumber = '10100'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please list the top three product names with the highest unit price.",
        "query": "SELECT t1.productName FROM products AS t1 INNER JOIN orderdetails AS t2 ON t1.productCode = t2.productCode ORDER BY t2.priceEach DESC LIMIT 3"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Among the customers of empolyee 1370, who has the highest credit limit?Please list the full name of the contact person.",
        "query": "SELECT t2.contactFirstName, t2.contactLastName FROM employees AS t1 INNER JOIN customers AS t2 ON t1.employeeNumber = t2.salesRepEmployeeNumber WHERE t1.employeeNumber = '1370' ORDER BY t2.creditLimit DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many 2003 Harley-Davidson Eagle Drag Bikes were ordered?",
        "query": "SELECT SUM(t2.quantityOrdered) FROM products AS t1 INNER JOIN orderdetails AS t2 ON t1.productCode = t2.productCode WHERE t1.productName = '2003 Harley-Davidson Eagle Drag Bike'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "When was the product with the highest unit price shipped?",
        "query": "SELECT t1.shippedDate FROM orders AS t1 INNER JOIN orderdetails AS t2 ON t1.orderNumber = t2.orderNumber ORDER BY t2.priceEach DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many motorcycles have been ordered in 2004?",
        "query": "SELECT SUM(t2.quantityOrdered) FROM orders AS t1 INNER JOIN orderdetails AS t2 ON t1.orderNumber = t2.orderNumber INNER JOIN products AS t3 ON t2.productCode = t3.productCode WHERE t3.productLine = 'motorcycles' AND STRFTIME('%Y', t1.orderDate) = '2004'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Please list the order number of the customer whose credit card has a limit of 45300.",
        "query": "SELECT t1.orderNumber FROM orders AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE t2.creditLimit = 45300"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "For Which order was the most profitable, please list the customer name of the order and the profit of the order.",
        "query": "SELECT t3.customerName, (t1.priceEach - t4.buyPrice) * t1.quantityOrdered FROM orderdetails AS t1 INNER JOIN orders AS t2 ON t1.orderNumber = t2.orderNumber INNER JOIN customers AS t3 ON t2.customerNumber = t3.customerNumber INNER JOIN products AS t4 ON t1.productCode = t4.productCode GROUP BY t3.customerName, t1.priceEach, t4.buyPrice, t1.quantityOrdered ORDER BY (t1.priceEach - t4.buyPrice) * t1.quantityOrdered DESC LIMIT 1"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many transactions payment made by customer that is lower than 10000. Group the result by year.",
        "query": "SELECT STRFTIME('%Y', t1.paymentDate), COUNT(t1.customerNumber) FROM payments AS t1 WHERE t1.amount < 10000 GROUP BY STRFTIME('%Y', t1.paymentDate)"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List out 3 best seller products during year 2003 with their total quantity sold during 2003.",
        "query": "SELECT t3.productName, SUM(t2.quantityOrdered) FROM orders AS t1 INNER JOIN orderdetails AS t2 ON t1.orderNumber = t2.orderNumber INNER JOIN products AS t3 ON t2.productCode = t3.productCode WHERE STRFTIME('%Y', t1.orderDate) = '2003' GROUP BY t3.productName ORDER BY SUM(t2.quantityOrdered) DESC LIMIT 3"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List out sale rep that has sold 1969 Harley Davidson Ultimate Chopper. List out their names and quantity sold throughout the year.",
        "query": "SELECT t5.firstName, t5.lastName, SUM(t2.quantityOrdered) FROM products AS t1 INNER JOIN orderdetails AS t2 ON t1.productCode = t2.productCode INNER JOIN orders AS t3 ON t2.orderNumber = t3.orderNumber INNER JOIN customers AS t4 ON t3.customerNumber = t4.customerNumber INNER JOIN employees AS t5 ON t4.salesRepEmployeeNumber = t5.employeeNumber WHERE t1.productName = '1969 Harley Davidson Ultimate Chopper' GROUP BY t5.lastName, t5.firstName"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Who are the sales representatives in New York City? List their full names.",
        "query": "SELECT t1.lastName, t1.firstName FROM employees AS t1 INNER JOIN offices AS t2 ON t1.officeCode = t2.officeCode WHERE t2.city = 'NYC' AND t1.jobTitle = 'Sales Rep'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Identify the customer and list down the country with the check number GG31455.",
        "query": "SELECT t2.customerName, t2.country FROM payments AS t1 INNER JOIN customers AS t2 ON t1.customerNumber = t2.customerNumber WHERE t1.checkNumber = 'GG31455'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many 2001 Ferrari Enzo were ordered?",
        "query": "SELECT SUM(t1.orderNumber) FROM orderdetails AS t1 INNER JOIN products AS t2 ON t1.productCode = t2.productCode WHERE t2.productName = '2001 Ferrari Enzo'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Which 5 products has the lowest amount of orders? List the product names.",
        "query": "SELECT t2.productName FROM orderdetails AS t1 INNER JOIN products AS t2 ON t1.productCode = t2.productCode GROUP BY t2.productName ORDER BY SUM(t1.quantityOrdered) ASC LIMIT 5"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "List down the customer names with a disputed order status.",
        "query": "SELECT t1.customerName FROM customers AS t1 INNER JOIN orders AS t2 ON t1.customerNumber = t2.customerNumber WHERE t2.status = 'Disputed'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "How many countries from the USA have an In Process order status?",
        "query": "SELECT COUNT(t2.orderNumber) FROM customers AS t1 INNER JOIN orders AS t2 ON t1.customerNumber = t2.customerNumber WHERE t2.status = 'On Hold' AND t1.country = 'USA'"
    },
    {
        "dataset": "bird_training",
        "db_id": "car_retails",
        "question": "Calculate the total price of shipped orders belonging to Land of Toys Inc. under the classic car line of products.",
        "query": "SELECT SUM(t3.priceEach * t3.quantityOrdered) FROM customers AS t1 INNER JOIN orders AS t2 ON t1.customerNumber = t2.customerNumber INNER JOIN orderdetails AS t3 ON t2.orderNumber = t3.orderNumber INNER JOIN products AS t4 ON t3.productCode = t4.productCode WHERE t4.productLine = 'Classic Cars' AND t1.customerName = 'Land of Toys Inc.' AND t2.status = 'Shipped'"
    }
]